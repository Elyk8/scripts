#!/bin/sh

config="$HOME/.config/kmonad/kmonad.kbd"
keyb1="/dev/input/by-id/usb-Lenovo_ThinkPad_Compact_USB_Keyboard_with_TrackPoint-event-kbd"
keyb2="/dev/input/by-id/usb-Razer_Razer_BlackWidow_Tournament_Edition-event-kbd"
killall kmonad

sleep 0.1

setsid -f kmonad $config

sleep 0.1

if test -e $keyb1; then
    echo "Activate KMonad for Lenovo Thinkpad keyboard"
    dest="/tmp/kmonad-lenovo.kbd"
    cp $config $dest
    sed -i 's:/dev/input/by-path/platform-i8042-serio-0-event-kbd:'$keyb1':' $dest
    setsid -f kmonad $dest
fi

sleep 0.1

if test -e $keyb2; then
    echo "Activate KMonad for Razer Black Widow Tournament Edition"
    dest="/tmp/kmonad-lenovo.kbd"
    cp $config $dest
    sed -i 's:/dev/input/by-path/platform-i8042-serio-0-event-kbd:'$keyb2':' $dest
    setsid -f kmonad $dest
fi
